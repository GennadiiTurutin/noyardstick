import { Injectable, NgModule, Component, Input, Output, EventEmitter, Inject, defineInjectable, inject } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { DOCUMENT } from '@angular/platform-browser';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
/**
 * @abstract
 */
class BaseLoginProviderImpl {
    constructor() { }
    /**
     * @param {?} obj
     * @param {?} onload
     * @return {?}
     */
    loadScript(obj, onload) {
        if (document.getElementById(obj.name)) {
            return;
        }
        /** @type {?} */
        let signInJS = document.createElement('script');
        signInJS.async = true;
        signInJS.src = obj.url;
        signInJS.onload = onload;
        if (obj.name === 'linkedin') {
            signInJS.async = false;
            signInJS.text = ('api_key: ' + obj.id).replace('\'', '');
        }
        document.head.appendChild(signInJS);
    }
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class SocialUser {
}
class LoginProviderClass {
}

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class FacebookLoginProvider extends BaseLoginProviderImpl {
    /**
     * @param {?} clientId
     */
    constructor(clientId) {
        super();
        this.clientId = clientId;
        this.TYPE = 'facebook';
        this.loginProviderObj = new LoginProviderClass();
        this.loginProviderObj.id = clientId;
        this.loginProviderObj.name = 'facebook';
        this.loginProviderObj.url = 'https://connect.facebook.net/en_US/sdk.js';
    }
    /**
     * @return {?}
     */
    initialize() {
        return new Promise((resolve, reject) => {
            this.loadScript(this.loginProviderObj, () => {
                FB.init({
                    appId: this.clientId,
                    autoLogAppEvents: true,
                    cookie: true,
                    xfbml: true,
                    version: 'v2.8'
                });
                FB.AppEvents.logPageView();
                FB.getLoginStatus(function (response) {
                    if (response.status === 'connected') {
                        /** @type {?} */
                        const accessToken = FB.getAuthResponse()['accessToken'];
                        FB.api('/me?fields=name,email,picture', (res) => {
                            resolve(FacebookLoginProvider.drawUser(Object.assign({}, { token: accessToken }, res)));
                        });
                    }
                });
            });
        });
    }
    /**
     * @param {?} response
     * @return {?}
     */
    static drawUser(response) {
        /** @type {?} */
        let user = new SocialUser();
        user.id = response.id;
        user.name = response.name;
        user.email = response.email;
        user.accessToken = response.accessToken;
        user.image = 'https://graph.facebook.com/' + response.id + '/picture?type=normal';
        return user;
    }
    /**
     * @param {?=} scopes
     * @return {?}
     */
    signIn(scopes) {
        return new Promise((resolve, reject) => {
            FB.login((response) => {
                console.log("facebook", response);
                if (response.authResponse) {
                    /** @type {?} */
                    const accessToken = FB.getAuthResponse()['accessToken'];
                    FB.api('/me?fields=name,email,picture', (res) => {
                        console.log("me", res);
                        resolve(FacebookLoginProvider.drawUser(Object.assign({}, { accessToken: accessToken }, res)));
                    });
                }
            }, { scope: scopes && scopes.length > 0 ? scopes.join(',') : 'email,public_profile' });
        });
    }
    /**
     * @param {?=} share
     * @return {?}
     */
    sharing(share) {
        return new Promise((resolve, reject) => {
            console.log("sharing", share);
            FB.ui({
                method: 'share',
                href: share.href,
                hashtag: (share.hashtag && share.hashtag.indexOf('#') >= 0) ? share.hashtag : null
            }, function (response) {
                console.log(response);
            });
        });
    }
    /**
     * @return {?}
     */
    signOut() {
        return new Promise((resolve, reject) => {
            FB.logout((response) => {
                resolve();
            });
        });
    }
}
FacebookLoginProvider.PROVIDER_TYPE = 'facebook';
FacebookLoginProvider.SCOPES = {
    EMAIL: 'email',
    PUBLIC_PROFILE: 'public_profile'
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class GoogleLoginProvider extends BaseLoginProviderImpl {
    /**
     * @param {?} clientId
     */
    constructor(clientId) {
        super();
        this.clientId = clientId;
        this.loginProviderObj = new LoginProviderClass();
        this.TYPE = 'google';
        this.loginProviderObj.id = clientId;
        this.loginProviderObj.name = 'google';
        this.loginProviderObj.url = 'https://apis.google.com/js/platform.js';
    }
    /**
     * @return {?}
     */
    initialize() {
        return new Promise((resolve, reject) => {
            this.loadScript(this.loginProviderObj, () => {
                gapi.load('auth2', () => {
                    this.auth2 = gapi.auth2.init({
                        client_id: this.clientId,
                        scope: 'email'
                    });
                    this.auth2.then(() => {
                        if (this.auth2.isSignedIn.get()) {
                            resolve(this.drawUser());
                        }
                    });
                });
            });
        });
    }
    /**
     * @return {?}
     */
    drawUser() {
        /** @type {?} */
        let user = new SocialUser();
        /** @type {?} */
        let profile = this.auth2.currentUser.get().getBasicProfile();
        /** @type {?} */
        let authResponseObj = this.auth2.currentUser.get().getAuthResponse(true);
        user.id = profile.getId();
        user.name = profile.getName();
        user.email = profile.getEmail();
        user.image = profile.getImageUrl();
        user.accessToken = authResponseObj.access_token;
        user.idToken = authResponseObj.id_token;
        return user;
    }
    /**
     * @param {?=} scopes
     * @return {?}
     */
    signIn(scopes) {
        return new Promise((resolve, reject) => {
            /** @type {?} */
            let promise = this.auth2.signIn();
            promise.then(() => {
                resolve(this.drawUser());
            }).catch((err) => {
                reject(err);
            });
        });
    }
    /**
     * @return {?}
     */
    signOut() {
        return new Promise((resolve, reject) => {
            this.auth2.signOut().then((err) => {
                if (err) {
                    reject(err);
                }
                else {
                    resolve();
                }
            });
        });
    }
    /**
     * @param {?=} share
     * @return {?}
     */
    sharing(share) {
        return new Promise((resolve, reject) => {
            resolve();
        });
    }
}
GoogleLoginProvider.PROVIDER_TYPE = 'google';

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class SocialServiceConfig {
    /**
     * @param {?=} providers
     */
    constructor(providers) {
        this.providers = new Map();
        if (providers) {
            for (let i = 0; i < providers.length; i++) {
                /** @type {?} */
                let element = providers[i];
                this.providers.set(element.provider.TYPE, element.provider);
            }
        }
    }
    /**
     * @return {?}
     */
    getProviders() {
        return this.providers;
    }
    /**
     * @param {?} provider
     * @return {?}
     */
    addProvider(provider) {
        if (!this.providers.get(provider.TYPE)) {
            this.providers.set(provider.TYPE, provider);
        }
    }
    /**
     * @param {?} clientId
     * @return {?}
     */
    addFacebook(clientId) {
        this.addProvider(new FacebookLoginProvider(clientId));
        return this;
    }
    /**
     * @param {?} clientId
     * @return {?}
     */
    addGoogle(clientId) {
        this.addProvider(new GoogleLoginProvider(clientId));
        return this;
    }
}
class SocialService {
    /**
     * @param {?} config
     */
    constructor(config) {
        this._user = null;
        this._authState = new BehaviorSubject(null);
        this.providers = config.getProviders();
        this.providers.forEach((provider, key) => {
            provider.initialize().then((user) => {
                user.provider = key;
                this._user = user;
                this._authState.next(user);
            }).catch((err) => {
                // this._authState.next(null);
            });
        });
    }
    /**
     * @return {?}
     */
    get authState() {
        return this._authState.asObservable();
    }
    /**
     * @return {?}
     */
    isSocialLoggedIn() {
        console.log(this._user);
        return (this._user != null);
    }
    /**
     * @param {?=} share
     * @return {?}
     */
    facebookSharing(share) {
        return new Promise((resolve, reject) => {
            /** @type {?} */
            let providerObject = this.providers.get('facebook');
            if (providerObject) {
                providerObject.sharing(share).then(() => {
                    resolve(true);
                });
            }
            else {
                reject(SocialService.LOGIN_PROVIDER_NOT_FOUND);
            }
        });
    }
    /**
     * @param {?} providerType
     * @param {?=} scopes
     * @return {?}
     */
    signIn(providerType, scopes) {
        return new Promise((resolve, reject) => {
            /** @type {?} */
            let providerObject = this.providers.get(providerType);
            if (providerObject) {
                providerObject.signIn(scopes).then((user) => {
                    user.provider = providerType;
                    resolve(user);
                    this._user = user;
                    this._authState.next(user);
                }).catch((err) => {
                    reject(SocialService.USER_POPUP_CLOSE);
                });
            }
            else {
                reject(SocialService.LOGIN_PROVIDER_NOT_FOUND);
            }
        });
    }
    /**
     * @return {?}
     */
    signOut() {
        return new Promise((resolve, reject) => {
            if (this._user && this._user.provider) {
                /** @type {?} */
                let providerType = this._user.provider;
                /** @type {?} */
                let providerObject = this.providers.get(providerType);
                providerObject.signOut().then(() => {
                    this._user = null;
                    this._authState.next(null);
                    resolve();
                }).catch((err) => {
                    this._authState.next(null);
                });
            }
            else {
                reject(SocialService.LOGIN_PROVIDER_NOT_FOUND);
            }
        });
    }
}
SocialService.LOGIN_PROVIDER_NOT_FOUND = 'Login provider not found';
SocialService.USER_POPUP_CLOSE = 'User close the popup';
SocialService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] },
];
/** @nocollapse */
SocialService.ctorParameters = () => [
    { type: SocialServiceConfig }
];
/** @nocollapse */ SocialService.ngInjectableDef = defineInjectable({ factory: function SocialService_Factory() { return new SocialService(inject(SocialServiceConfig)); }, token: SocialService, providedIn: "root" });

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class FacebookLoginButton {
    /**
     * @param {?} socialAuthService
     */
    constructor(socialAuthService) {
        this.socialAuthService = socialAuthService;
        this.socialUser = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    socialSignIn() {
        this.socialAuthService.signIn('facebook', this.scopes).then((userData) => {
            console.log("socialSignIn", userData);
            this.socialUser.emit(userData);
        }).catch(() => {
            this.socialUser.emit(null);
        });
    }
}
FacebookLoginButton.decorators = [
    { type: Component, args: [{
                selector: 'facebook-login-button',
                template: `
      <button class="button btn-block loginBtn --facebook" 
              (click)="socialSignIn()" type="button">
          Login with Facebook</button>
  `,
                styles: [`.button{font-family:Lato,"Lucida Grande","Lucida Sans Unicode",Tahoma,Sans-Serif;-webkit-appearance:none;display:inline-block;outline:0;border-radius:3px;border:3px solid transparent;cursor:pointer;text-overflow:ellipsis;text-decoration:none!important;font-weight:400!important}.loginBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.loginBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.loginBtn:focus{outline:0}.loginBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.shareBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.shareBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.shareBtn:focus{outline:0}.shareBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.--facebook{background-color:#4c69ba;background-image:linear-gradient(#4c69ba,#3b55a0);text-shadow:0 -1px 0 #354c8c}.--facebook:before{border-right:1px solid #364e92;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_facebook.png) 6px 6px no-repeat}.--facebook:focus,.--facebook:hover{background-color:#5b7bd5;background-image:linear-gradient(#5b7bd5,#4864b1)}.--google{background:#dd4b39}.--google:before{border-right:1px solid #bb3f30;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_google.png) 6px 6px no-repeat}.--google:focus,.--google:hover{background:#e74b37}`],
            },] },
];
/** @nocollapse */
FacebookLoginButton.ctorParameters = () => [
    { type: SocialService }
];
FacebookLoginButton.propDecorators = {
    size: [{ type: Input }],
    scopes: [{ type: Input }],
    socialUser: [{ type: Output }]
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class GoogleLoginButton {
    /**
     * @param {?} socialAuthService
     */
    constructor(socialAuthService) {
        this.socialAuthService = socialAuthService;
        this.socialUser = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    socialSignIn() {
        this.socialAuthService.signIn('google', this.scopes).then((userData) => {
            this.socialUser.emit(userData);
        }).catch(() => {
            this.socialUser.emit(null);
        });
    }
}
GoogleLoginButton.decorators = [
    { type: Component, args: [{
                selector: 'google-login-button',
                template: `
      <button class="btn-block loginBtn --google" 
              (click)="socialSignIn()" type="button">
          Login with Google
      </button>
  `, styles: [`.button{font-family:Lato,"Lucida Grande","Lucida Sans Unicode",Tahoma,Sans-Serif;-webkit-appearance:none;display:inline-block;outline:0;border-radius:3px;border:3px solid transparent;cursor:pointer;text-overflow:ellipsis;text-decoration:none!important;font-weight:400!important}.loginBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.loginBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.loginBtn:focus{outline:0}.loginBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.shareBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.shareBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.shareBtn:focus{outline:0}.shareBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.--facebook{background-color:#4c69ba;background-image:linear-gradient(#4c69ba,#3b55a0);text-shadow:0 -1px 0 #354c8c}.--facebook:before{border-right:1px solid #364e92;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_facebook.png) 6px 6px no-repeat}.--facebook:focus,.--facebook:hover{background-color:#5b7bd5;background-image:linear-gradient(#5b7bd5,#4864b1)}.--google{background:#dd4b39}.--google:before{border-right:1px solid #bb3f30;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_google.png) 6px 6px no-repeat}.--google:focus,.--google:hover{background:#e74b37}`],
            },] },
];
/** @nocollapse */
GoogleLoginButton.ctorParameters = () => [
    { type: SocialService }
];
GoogleLoginButton.propDecorators = {
    size: [{ type: Input }],
    scopes: [{ type: Input }],
    socialUser: [{ type: Output }]
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class FacebookSharingButton {
    /**
     * @param {?} socialAuthService
     * @param {?} document
     */
    constructor(socialAuthService, document) {
        this.socialAuthService = socialAuthService;
        this.document = document;
        this.share = null;
        this.response = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
    }
    /**
     * @return {?}
     */
    sharing() {
        console.log(this.document.location.href);
        if (!this.share) {
            this.share = { href: this.document.location.href };
        }
        else if (!this.share.href) {
            this.share.href = this.document.location.href;
        }
        this.socialAuthService.facebookSharing(this.share).then(() => {
            this.response.emit(true);
        }).catch((err) => {
            this.response.emit(false);
        });
    }
}
FacebookSharingButton.decorators = [
    { type: Component, args: [{
                selector: 'facebook-share-button',
                template: `
      <button class="button btn-block loginBtn --facebook" 
              (click)="sharing()" type="button">Share</button>
  `,
                styles: [`.button{font-family:Lato,"Lucida Grande","Lucida Sans Unicode",Tahoma,Sans-Serif;-webkit-appearance:none;display:inline-block;outline:0;border-radius:3px;border:3px solid transparent;cursor:pointer;text-overflow:ellipsis;text-decoration:none!important;font-weight:400!important}.loginBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.loginBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.loginBtn:focus{outline:0}.loginBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.shareBtn{box-sizing:border-box;position:relative;margin:.2em;padding:0 15px 0 46px;border:none;text-align:left;line-height:34px;white-space:nowrap;border-radius:3px;font-size:16px;color:#fff}.shareBtn:before{content:"";box-sizing:border-box;position:absolute;top:0;left:0;width:34px;height:100%}.shareBtn:focus{outline:0}.shareBtn:active{box-shadow:inset 0 0 0 32px rgba(0,0,0,.1)}.--facebook{background-color:#4c69ba;background-image:linear-gradient(#4c69ba,#3b55a0);text-shadow:0 -1px 0 #354c8c}.--facebook:before{border-right:1px solid #364e92;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_facebook.png) 6px 6px no-repeat}.--facebook:focus,.--facebook:hover{background-color:#5b7bd5;background-image:linear-gradient(#5b7bd5,#4864b1)}.--google{background:#dd4b39}.--google:before{border-right:1px solid #bb3f30;background:url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/14082/icon_google.png) 6px 6px no-repeat}.--google:focus,.--google:hover{background:#e74b37}`],
            },] },
];
/** @nocollapse */
FacebookSharingButton.ctorParameters = () => [
    { type: SocialService },
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] }
];
FacebookSharingButton.propDecorators = {
    share: [{ type: Input }],
    response: [{ type: Output }]
};

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
class Angular6SocialButtonModule {
}
Angular6SocialButtonModule.decorators = [
    { type: NgModule, args: [{
                imports: [],
                declarations: [FacebookLoginButton, GoogleLoginButton, FacebookSharingButton],
                exports: [FacebookLoginButton, GoogleLoginButton, FacebookSharingButton]
            },] },
];

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */

export { SocialServiceConfig, SocialService, FacebookLoginProvider, GoogleLoginProvider, FacebookLoginButton, GoogleLoginButton, FacebookSharingButton, Angular6SocialButtonModule, BaseLoginProviderImpl as ɵa };

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi5qcy5tYXAiLCJzb3VyY2VzIjpbIm5nOi8vYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi9saWIvZW50aXRpZXMvYmFzZUxvZ2luUHJvdmlkZXJJbXBsLnRzIiwibmc6Ly9hbmd1bGFyNi1zb2NpYWwtYnV0dG9uL2xpYi9lbnRpdGllcy91c2VyLnRzIiwibmc6Ly9hbmd1bGFyNi1zb2NpYWwtYnV0dG9uL2xpYi9wcm92aWRlcnMvZmFjZWJvb2tQcm92aWRlci50cyIsIm5nOi8vYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi9saWIvcHJvdmlkZXJzL2dvb2dsZVByb3ZpZGVyLnRzIiwibmc6Ly9hbmd1bGFyNi1zb2NpYWwtYnV0dG9uL2xpYi9zb2NpYWwuc2VydmljZS50cyIsIm5nOi8vYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi9saWIvYnV0dG9ucy9mYWNlYm9va0xvZ2luQnV0dG9uLnRzIiwibmc6Ly9hbmd1bGFyNi1zb2NpYWwtYnV0dG9uL2xpYi9idXR0b25zL2dvb2dsZUxvZ2luQnV0dG9uLnRzIiwibmc6Ly9hbmd1bGFyNi1zb2NpYWwtYnV0dG9uL2xpYi9idXR0b25zL2ZhY2Vib29rU2hhcmluZ0J1dHRvbi50cyIsIm5nOi8vYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi9saWIvYW5ndWxhcjYtc29jaWFsLWJ1dHRvbi5tb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTG9naW5Qcm92aWRlciB9IGZyb20gJy4vbG9naW5Qcm92aWRlcic7XHJcbmltcG9ydCB7IFNvY2lhbFVzZXIsIExvZ2luUHJvdmlkZXJDbGFzcyB9IGZyb20gJy4vdXNlcic7XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZUxvZ2luUHJvdmlkZXJJbXBsIGltcGxlbWVudHMgTG9naW5Qcm92aWRlciB7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgYWJzdHJhY3QgaW5pdGlhbGl6ZSgpOiBQcm9taXNlPFNvY2lhbFVzZXI+O1xyXG4gIGFic3RyYWN0IHNpZ25JbihzY29wZXM/OltzdHJpbmddKTogUHJvbWlzZTxTb2NpYWxVc2VyPjtcclxuICBhYnN0cmFjdCBzaWduT3V0KCk6IFByb21pc2U8YW55PjtcclxuICBhYnN0cmFjdCBzaGFyaW5nKHNoYXJlPzphbnkpOlByb21pc2U8YW55PjtcclxuICBhYnN0cmFjdCBUWVBFOiBzdHJpbmc7XHJcblxyXG4gIGxvYWRTY3JpcHQob2JqOiBMb2dpblByb3ZpZGVyQ2xhc3MsIG9ubG9hZDogYW55KTogdm9pZCB7XHJcbiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob2JqLm5hbWUpKSB7IHJldHVybjsgfVxyXG4gICAgbGV0IHNpZ25JbkpTID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7XHJcbiAgICBzaWduSW5KUy5hc3luYyA9IHRydWU7XHJcbiAgICBzaWduSW5KUy5zcmMgPSBvYmoudXJsO1xyXG4gICAgc2lnbkluSlMub25sb2FkID0gb25sb2FkO1xyXG4gICAgaWYgKG9iai5uYW1lID09PSAnbGlua2VkaW4nKSB7XHJcbiAgICAgIHNpZ25JbkpTLmFzeW5jID0gZmFsc2U7XHJcbiAgICAgIHNpZ25JbkpTLnRleHQgPSAoJ2FwaV9rZXk6ICcgKyBvYmouaWQpLnJlcGxhY2UoJ1xcJycsICcnKTtcclxuICAgIH1cclxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2lnbkluSlMpO1xyXG4gIH1cclxufSIsImV4cG9ydCBjbGFzcyBTb2NpYWxVc2VyIHtcclxuICAgIHByb3ZpZGVyOiBzdHJpbmc7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgZW1haWw6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGltYWdlOiBzdHJpbmc7XHJcbiAgICBhY2Nlc3NUb2tlbj86IHN0cmluZztcclxuICAgIGlkVG9rZW4/OiBzdHJpbmdcclxuICB9XHJcbiAgXHJcbiAgZXhwb3J0IGNsYXNzIExvZ2luUHJvdmlkZXJDbGFzcyB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgdXJsOiBzdHJpbmc7XHJcbiAgfVxyXG4gIFxyXG4gIGV4cG9ydCBjbGFzcyBMaW5rZWRJblJlc3BvbnNlIHtcclxuICAgIGVtYWlsQWRkcmVzczogc3RyaW5nO1xyXG4gICAgZmlyc3ROYW1lOiBzdHJpbmc7XHJcbiAgICBpZDogc3RyaW5nO1xyXG4gICAgbGFzdE5hbWU6IHN0cmluZztcclxuICAgIHBpY3R1cmVVcmw6IHN0cmluZztcclxuICB9XHJcbiIsImltcG9ydCB7IEJhc2VMb2dpblByb3ZpZGVySW1wbCB9IGZyb20gJy4uL2VudGl0aWVzL2Jhc2VMb2dpblByb3ZpZGVySW1wbCc7XHJcbmltcG9ydCB7IFNvY2lhbFVzZXIsIExvZ2luUHJvdmlkZXJDbGFzcyB9IGZyb20gJy4uL2VudGl0aWVzL3VzZXInO1xyXG5cclxuZGVjbGFyZSBsZXQgRkI6IGFueTtcclxuXHJcbmV4cG9ydCBjbGFzcyBGYWNlYm9va0xvZ2luUHJvdmlkZXIgZXh0ZW5kcyBCYXNlTG9naW5Qcm92aWRlckltcGwge1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFBST1ZJREVSX1RZUEUgPSAnZmFjZWJvb2snO1xyXG4gIHB1YmxpYyBzdGF0aWMgcmVhZG9ubHkgU0NPUEVTID0ge1xyXG4gICAgRU1BSUwgOiAnZW1haWwnLFxyXG4gICAgUFVCTElDX1BST0ZJTEU6ICdwdWJsaWNfcHJvZmlsZSdcclxuICB9O1xyXG5cclxuICBwdWJsaWMgVFlQRSA9ICdmYWNlYm9vayc7XHJcbiAgcHVibGljIGxvZ2luUHJvdmlkZXJPYmo6IExvZ2luUHJvdmlkZXJDbGFzcyA9IG5ldyBMb2dpblByb3ZpZGVyQ2xhc3MoKTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBjbGllbnRJZDogc3RyaW5nKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gICAgdGhpcy5sb2dpblByb3ZpZGVyT2JqLmlkID0gY2xpZW50SWQ7XHJcbiAgICB0aGlzLmxvZ2luUHJvdmlkZXJPYmoubmFtZSA9ICdmYWNlYm9vayc7XHJcbiAgICB0aGlzLmxvZ2luUHJvdmlkZXJPYmoudXJsID0gJ2h0dHBzOi8vY29ubmVjdC5mYWNlYm9vay5uZXQvZW5fVVMvc2RrLmpzJztcclxuICB9XHJcblxyXG4gIGluaXRpYWxpemUoKTogUHJvbWlzZTxTb2NpYWxVc2VyPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmxvYWRTY3JpcHQodGhpcy5sb2dpblByb3ZpZGVyT2JqLCAoKSA9PiB7XHJcbiAgICAgICAgICBGQi5pbml0KHtcclxuICAgICAgICAgICAgYXBwSWQ6IHRoaXMuY2xpZW50SWQsXHJcbiAgICAgICAgICAgIGF1dG9Mb2dBcHBFdmVudHM6IHRydWUsXHJcbiAgICAgICAgICAgIGNvb2tpZTogdHJ1ZSxcclxuICAgICAgICAgICAgeGZibWw6IHRydWUsXHJcbiAgICAgICAgICAgIHZlcnNpb246ICd2Mi44J1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBGQi5BcHBFdmVudHMubG9nUGFnZVZpZXcoKTtcclxuXHJcbiAgICAgICAgICBGQi5nZXRMb2dpblN0YXR1cyhmdW5jdGlvbiAocmVzcG9uc2U6IGFueSkge1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAnY29ubmVjdGVkJykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gRkIuZ2V0QXV0aFJlc3BvbnNlKClbJ2FjY2Vzc1Rva2VuJ107XHJcbiAgICAgICAgICAgICAgRkIuYXBpKCcvbWU/ZmllbGRzPW5hbWUsZW1haWwscGljdHVyZScsIChyZXM6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShGYWNlYm9va0xvZ2luUHJvdmlkZXIuZHJhd1VzZXIoT2JqZWN0LmFzc2lnbih7fSwge3Rva2VuOiBhY2Nlc3NUb2tlbn0sIHJlcykpKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBkcmF3VXNlcihyZXNwb25zZTogYW55KTogU29jaWFsVXNlciB7XHJcbiAgICBsZXQgdXNlcjogU29jaWFsVXNlciA9IG5ldyBTb2NpYWxVc2VyKCk7XHJcbiAgICB1c2VyLmlkID0gcmVzcG9uc2UuaWQ7XHJcbiAgICB1c2VyLm5hbWUgPSByZXNwb25zZS5uYW1lO1xyXG4gICAgdXNlci5lbWFpbCA9IHJlc3BvbnNlLmVtYWlsO1xyXG4gICAgdXNlci5hY2Nlc3NUb2tlbiA9IHJlc3BvbnNlLmFjY2Vzc1Rva2VuO1xyXG4gICAgdXNlci5pbWFnZSA9ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8nICsgcmVzcG9uc2UuaWQgKyAnL3BpY3R1cmU/dHlwZT1ub3JtYWwnO1xyXG4gICAgcmV0dXJuIHVzZXI7XHJcbiAgfVxyXG5cclxuXHJcbiAgc2lnbkluKHNjb3Blcz86W3N0cmluZ10pOiBQcm9taXNlPFNvY2lhbFVzZXI+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIEZCLmxvZ2luKChyZXNwb25zZTogYW55KSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJmYWNlYm9va1wiLCByZXNwb25zZSk7XHJcbiAgICAgICAgaWYgKHJlc3BvbnNlLmF1dGhSZXNwb25zZSkge1xyXG4gICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBGQi5nZXRBdXRoUmVzcG9uc2UoKVsnYWNjZXNzVG9rZW4nXTtcclxuICAgICAgICAgIEZCLmFwaSgnL21lP2ZpZWxkcz1uYW1lLGVtYWlsLHBpY3R1cmUnLCAocmVzOiBhbnkpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtZVwiLCByZXMpO1xyXG4gICAgICAgICAgICByZXNvbHZlKEZhY2Vib29rTG9naW5Qcm92aWRlci5kcmF3VXNlcihPYmplY3QuYXNzaWduKHt9LCB7YWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VufSwgcmVzKSkpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LCB7IHNjb3BlOiBzY29wZXMgJiYgc2NvcGVzLmxlbmd0aCA+IDAgPyBzY29wZXMuam9pbignLCcpIDogJ2VtYWlsLHB1YmxpY19wcm9maWxlJyB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2hhcmluZyhzaGFyZT86YW55KTogUHJvbWlzZTxhbnk+e1xyXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJzaGFyaW5nXCIsIHNoYXJlKTtcclxuICAgICAgICAgICAgRkIudWkoe1xyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnc2hhcmUnLFxyXG4gICAgICAgICAgICAgICAgaHJlZjogc2hhcmUuaHJlZixcclxuICAgICAgICAgICAgICAgIGhhc2h0YWc6IChzaGFyZS5oYXNodGFnICYmIHNoYXJlLmhhc2h0YWcuaW5kZXhPZignIycpPj0wKT9zaGFyZS5oYXNodGFnIDogIG51bGxcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBzaWduT3V0KCk6IFByb21pc2U8YW55PiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBGQi5sb2dvdXQoKHJlc3BvbnNlOiBhbnkpID0+IHtcclxuICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufSIsImltcG9ydCB7IEJhc2VMb2dpblByb3ZpZGVySW1wbCB9IGZyb20gJy4uL2VudGl0aWVzL2Jhc2VMb2dpblByb3ZpZGVySW1wbCc7XHJcbmltcG9ydCB7IFNvY2lhbFVzZXIsIExvZ2luUHJvdmlkZXJDbGFzcyB9IGZyb20gJy4uL2VudGl0aWVzL3VzZXInO1xyXG5cclxuZGVjbGFyZSBsZXQgZ2FwaTogYW55O1xyXG5cclxuZXhwb3J0IGNsYXNzIEdvb2dsZUxvZ2luUHJvdmlkZXIgZXh0ZW5kcyBCYXNlTG9naW5Qcm92aWRlckltcGwge1xyXG5cclxuICBwdWJsaWMgc3RhdGljIHJlYWRvbmx5IFBST1ZJREVSX1RZUEUgPSAnZ29vZ2xlJztcclxuICBwdWJsaWMgbG9naW5Qcm92aWRlck9iajogTG9naW5Qcm92aWRlckNsYXNzID0gbmV3IExvZ2luUHJvdmlkZXJDbGFzcygpO1xyXG4gIHByaXZhdGUgYXV0aDI6IGFueTtcclxuICBwdWJsaWMgVFlQRSA9ICdnb29nbGUnO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNsaWVudElkOiBzdHJpbmcpIHtcclxuICAgIHN1cGVyKCk7XHJcbiAgICB0aGlzLmxvZ2luUHJvdmlkZXJPYmouaWQgPSBjbGllbnRJZDtcclxuICAgIHRoaXMubG9naW5Qcm92aWRlck9iai5uYW1lID0gJ2dvb2dsZSc7XHJcbiAgICB0aGlzLmxvZ2luUHJvdmlkZXJPYmoudXJsID0gJ2h0dHBzOi8vYXBpcy5nb29nbGUuY29tL2pzL3BsYXRmb3JtLmpzJztcclxuICB9XHJcblxyXG4gIGluaXRpYWxpemUoKTogUHJvbWlzZTxTb2NpYWxVc2VyPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmxvYWRTY3JpcHQodGhpcy5sb2dpblByb3ZpZGVyT2JqLCAoKSA9PiB7XHJcbiAgICAgICAgICBnYXBpLmxvYWQoJ2F1dGgyJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGgyID0gZ2FwaS5hdXRoMi5pbml0KHtcclxuICAgICAgICAgICAgICBjbGllbnRfaWQ6IHRoaXMuY2xpZW50SWQsXHJcbiAgICAgICAgICAgICAgc2NvcGU6ICdlbWFpbCdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmF1dGgyLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGlmICh0aGlzLmF1dGgyLmlzU2lnbmVkSW4uZ2V0KCkpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5kcmF3VXNlcigpKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkcmF3VXNlcigpOiBTb2NpYWxVc2VyIHtcclxuICAgIGxldCB1c2VyOiBTb2NpYWxVc2VyID0gbmV3IFNvY2lhbFVzZXIoKTtcclxuICAgIGxldCBwcm9maWxlID0gdGhpcy5hdXRoMi5jdXJyZW50VXNlci5nZXQoKS5nZXRCYXNpY1Byb2ZpbGUoKTtcclxuICAgIGxldCBhdXRoUmVzcG9uc2VPYmogPSB0aGlzLmF1dGgyLmN1cnJlbnRVc2VyLmdldCgpLmdldEF1dGhSZXNwb25zZSh0cnVlKTtcclxuICAgIHVzZXIuaWQgPSBwcm9maWxlLmdldElkKCk7XHJcbiAgICB1c2VyLm5hbWUgPSBwcm9maWxlLmdldE5hbWUoKTtcclxuICAgIHVzZXIuZW1haWwgPSBwcm9maWxlLmdldEVtYWlsKCk7XHJcbiAgICB1c2VyLmltYWdlID0gcHJvZmlsZS5nZXRJbWFnZVVybCgpO1xyXG4gICAgdXNlci5hY2Nlc3NUb2tlbiA9IGF1dGhSZXNwb25zZU9iai5hY2Nlc3NfdG9rZW47XHJcbiAgICB1c2VyLmlkVG9rZW4gPSBhdXRoUmVzcG9uc2VPYmouaWRfdG9rZW47XHJcbiAgICByZXR1cm4gdXNlcjtcclxuICB9XHJcblxyXG4gIHNpZ25JbihzY29wZXM/OltzdHJpbmddKTogUHJvbWlzZTxTb2NpYWxVc2VyPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBsZXQgcHJvbWlzZSA9IHRoaXMuYXV0aDIuc2lnbkluKCk7XHJcbiAgICAgIHByb21pc2UudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcmVzb2x2ZSh0aGlzLmRyYXdVc2VyKCkpO1xyXG4gICAgICB9KS5jYXRjaCgoZXJyKT0+e1xyXG4gICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzaWduT3V0KCk6IFByb21pc2U8YW55PiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICB0aGlzLmF1dGgyLnNpZ25PdXQoKS50aGVuKChlcnI6IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgICBzaGFyaW5nKHNoYXJlPzogYW55KTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHtJbmplY3RhYmxlfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7QmVoYXZpb3JTdWJqZWN0fSBmcm9tICdyeGpzJztcclxuXHJcbmltcG9ydCB7TG9naW5Qcm92aWRlcn0gZnJvbSAnLi9lbnRpdGllcy9sb2dpblByb3ZpZGVyJztcclxuaW1wb3J0IHtGYWNlYm9va0xvZ2luUHJvdmlkZXJ9IGZyb20gXCIuL3Byb3ZpZGVycy9mYWNlYm9va1Byb3ZpZGVyXCI7XHJcbmltcG9ydCB7R29vZ2xlTG9naW5Qcm92aWRlcn0gZnJvbSBcIi4vcHJvdmlkZXJzL2dvb2dsZVByb3ZpZGVyXCI7XHJcblxyXG5pbXBvcnQge1NvY2lhbFVzZXJ9IGZyb20gJy4vZW50aXRpZXMvdXNlcic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFNvY2lhbFNlcnZpY2VDb25maWdJdGVtIHtcclxuICAgIHByb3ZpZGVyOiBMb2dpblByb3ZpZGVyO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgU29jaWFsU2VydmljZUNvbmZpZyB7XHJcbiAgICBwcml2YXRlIHByb3ZpZGVyczogTWFwPHN0cmluZywgTG9naW5Qcm92aWRlcj4gPSBuZXcgTWFwPHN0cmluZywgTG9naW5Qcm92aWRlcj4oKTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihwcm92aWRlcnM/OiBTb2NpYWxTZXJ2aWNlQ29uZmlnSXRlbVtdKSB7XHJcbiAgICAgICAgaWYgKHByb3ZpZGVycykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3ZpZGVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBwcm92aWRlcnNbaV07XHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb3ZpZGVycy5zZXQoZWxlbWVudC5wcm92aWRlci5UWVBFLCBlbGVtZW50LnByb3ZpZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRQcm92aWRlcnMoKXtcclxuICAgICAgICByZXR1cm4gdGhpcy5wcm92aWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhZGRQcm92aWRlcihwcm92aWRlcjogTG9naW5Qcm92aWRlcikge1xyXG4gICAgICAgIGlmICghdGhpcy5wcm92aWRlcnMuZ2V0KHByb3ZpZGVyLlRZUEUpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJvdmlkZXJzLnNldChwcm92aWRlci5UWVBFLCBwcm92aWRlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGRGYWNlYm9vayhjbGllbnRJZDogc3RyaW5nKTpTb2NpYWxTZXJ2aWNlQ29uZmlnIHtcclxuICAgICAgICB0aGlzLmFkZFByb3ZpZGVyKG5ldyBGYWNlYm9va0xvZ2luUHJvdmlkZXIoY2xpZW50SWQpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBhZGRHb29nbGUoY2xpZW50SWQ6IHN0cmluZyk6U29jaWFsU2VydmljZUNvbmZpZyAge1xyXG4gICAgICAgIHRoaXMuYWRkUHJvdmlkZXIobmV3IEdvb2dsZUxvZ2luUHJvdmlkZXIoY2xpZW50SWQpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxyXG5cclxuQEluamVjdGFibGUoe1xyXG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBTb2NpYWxTZXJ2aWNlIHtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBMT0dJTl9QUk9WSURFUl9OT1RfRk9VTkQgPSAnTG9naW4gcHJvdmlkZXIgbm90IGZvdW5kJztcclxuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFVTRVJfUE9QVVBfQ0xPU0UgPSAnVXNlciBjbG9zZSB0aGUgcG9wdXAnO1xyXG5cclxuICAgIHByaXZhdGUgcHJvdmlkZXJzOiBNYXA8c3RyaW5nLCBMb2dpblByb3ZpZGVyPjtcclxuXHJcbiAgICBwcml2YXRlIF91c2VyOiBTb2NpYWxVc2VyID0gbnVsbDtcclxuICAgIHByaXZhdGUgX2F1dGhTdGF0ZTogQmVoYXZpb3JTdWJqZWN0PFNvY2lhbFVzZXI+ID0gbmV3IEJlaGF2aW9yU3ViamVjdChudWxsKTtcclxuXHJcbiAgICBnZXQgYXV0aFN0YXRlKCk6IE9ic2VydmFibGU8U29jaWFsVXNlcj4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9hdXRoU3RhdGUuYXNPYnNlcnZhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29uZmlnOiBTb2NpYWxTZXJ2aWNlQ29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMgPSBjb25maWcuZ2V0UHJvdmlkZXJzKCk7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMuZm9yRWFjaCgocHJvdmlkZXI6IExvZ2luUHJvdmlkZXIsIGtleTogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgIHByb3ZpZGVyLmluaXRpYWxpemUoKS50aGVuKCh1c2VyOiBTb2NpYWxVc2VyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB1c2VyLnByb3ZpZGVyID0ga2V5O1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdXNlciA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9hdXRoU3RhdGUubmV4dCh1c2VyKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fYXV0aFN0YXRlLm5leHQobnVsbCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGlzU29jaWFsTG9nZ2VkSW4oKXtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLl91c2VyKTtcclxuICAgICAgICByZXR1cm4gKHRoaXMuX3VzZXIgIT0gbnVsbClcclxuICAgIH1cclxuXHJcbiAgICBmYWNlYm9va1NoYXJpbmcoc2hhcmU/OmFueSl7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGV0IHByb3ZpZGVyT2JqZWN0ID0gdGhpcy5wcm92aWRlcnMuZ2V0KCdmYWNlYm9vaycpO1xyXG4gICAgICAgICAgICBpZiAocHJvdmlkZXJPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHByb3ZpZGVyT2JqZWN0LnNoYXJpbmcoc2hhcmUpLnRoZW4oKCk9PntcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZWplY3QoU29jaWFsU2VydmljZS5MT0dJTl9QUk9WSURFUl9OT1RfRk9VTkQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2lnbkluKHByb3ZpZGVyVHlwZTogc3RyaW5nLCBzY29wZXM/OiBbc3RyaW5nXSk6IFByb21pc2U8U29jaWFsVXNlcj4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBwcm92aWRlck9iamVjdCA9IHRoaXMucHJvdmlkZXJzLmdldChwcm92aWRlclR5cGUpO1xyXG4gICAgICAgICAgICBpZiAocHJvdmlkZXJPYmplY3QpIHtcclxuICAgICAgICAgICAgICAgIHByb3ZpZGVyT2JqZWN0LnNpZ25JbihzY29wZXMpLnRoZW4oKHVzZXI6IFNvY2lhbFVzZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLnByb3ZpZGVyID0gcHJvdmlkZXJUeXBlO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXNlciA9IHVzZXI7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXV0aFN0YXRlLm5leHQodXNlcik7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKT0+e1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChTb2NpYWxTZXJ2aWNlLlVTRVJfUE9QVVBfQ0xPU0UpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChTb2NpYWxTZXJ2aWNlLkxPR0lOX1BST1ZJREVSX05PVF9GT1VORCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzaWduT3V0KCk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3VzZXIgJiYgdGhpcy5fdXNlci5wcm92aWRlcikge1xyXG4gICAgICAgICAgICAgICAgbGV0IHByb3ZpZGVyVHlwZSA9IHRoaXMuX3VzZXIucHJvdmlkZXI7XHJcbiAgICAgICAgICAgICAgICBsZXQgcHJvdmlkZXJPYmplY3QgPSB0aGlzLnByb3ZpZGVycy5nZXQocHJvdmlkZXJUeXBlKTtcclxuICAgICAgICAgICAgICAgIHByb3ZpZGVyT2JqZWN0LnNpZ25PdXQoKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl91c2VyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdXRoU3RhdGUubmV4dChudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXV0aFN0YXRlLm5leHQobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChTb2NpYWxTZXJ2aWNlLkxPR0lOX1BST1ZJREVSX05PVF9GT1VORCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn1cclxuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlcn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7U29jaWFsU2VydmljZX0gZnJvbSAnLi4vc29jaWFsLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBTb2NpYWxVc2VyIH0gZnJvbSAnLi4vZW50aXRpZXMnO1xyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ2ZhY2Vib29rLWxvZ2luLWJ1dHRvbicsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ1dHRvbiBidG4tYmxvY2sgbG9naW5CdG4gLS1mYWNlYm9va1wiIFxyXG4gICAgICAgICAgICAgIChjbGljayk9XCJzb2NpYWxTaWduSW4oKVwiIHR5cGU9XCJidXR0b25cIj5cclxuICAgICAgICAgIExvZ2luIHdpdGggRmFjZWJvb2s8L2J1dHRvbj5cclxuICBgLFxyXG4gICAgc3R5bGVzOiBbYC5idXR0b257Zm9udC1mYW1pbHk6TGF0byxcIkx1Y2lkYSBHcmFuZGVcIixcIkx1Y2lkYSBTYW5zIFVuaWNvZGVcIixUYWhvbWEsU2Fucy1TZXJpZjstd2Via2l0LWFwcGVhcmFuY2U6bm9uZTtkaXNwbGF5OmlubGluZS1ibG9jaztvdXRsaW5lOjA7Ym9yZGVyLXJhZGl1czozcHg7Ym9yZGVyOjNweCBzb2xpZCB0cmFuc3BhcmVudDtjdXJzb3I6cG9pbnRlcjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzO3RleHQtZGVjb3JhdGlvbjpub25lIWltcG9ydGFudDtmb250LXdlaWdodDo0MDAhaW1wb3J0YW50fS5sb2dpbkJ0bntib3gtc2l6aW5nOmJvcmRlci1ib3g7cG9zaXRpb246cmVsYXRpdmU7bWFyZ2luOi4yZW07cGFkZGluZzowIDE1cHggMCA0NnB4O2JvcmRlcjpub25lO3RleHQtYWxpZ246bGVmdDtsaW5lLWhlaWdodDozNHB4O3doaXRlLXNwYWNlOm5vd3JhcDtib3JkZXItcmFkaXVzOjNweDtmb250LXNpemU6MTZweDtjb2xvcjojZmZmfS5sb2dpbkJ0bjpiZWZvcmV7Y29udGVudDpcIlwiO2JveC1zaXppbmc6Ym9yZGVyLWJveDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MzRweDtoZWlnaHQ6MTAwJX0ubG9naW5CdG46Zm9jdXN7b3V0bGluZTowfS5sb2dpbkJ0bjphY3RpdmV7Ym94LXNoYWRvdzppbnNldCAwIDAgMCAzMnB4IHJnYmEoMCwwLDAsLjEpfS5zaGFyZUJ0bntib3gtc2l6aW5nOmJvcmRlci1ib3g7cG9zaXRpb246cmVsYXRpdmU7bWFyZ2luOi4yZW07cGFkZGluZzowIDE1cHggMCA0NnB4O2JvcmRlcjpub25lO3RleHQtYWxpZ246bGVmdDtsaW5lLWhlaWdodDozNHB4O3doaXRlLXNwYWNlOm5vd3JhcDtib3JkZXItcmFkaXVzOjNweDtmb250LXNpemU6MTZweDtjb2xvcjojZmZmfS5zaGFyZUJ0bjpiZWZvcmV7Y29udGVudDpcIlwiO2JveC1zaXppbmc6Ym9yZGVyLWJveDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7d2lkdGg6MzRweDtoZWlnaHQ6MTAwJX0uc2hhcmVCdG46Zm9jdXN7b3V0bGluZTowfS5zaGFyZUJ0bjphY3RpdmV7Ym94LXNoYWRvdzppbnNldCAwIDAgMCAzMnB4IHJnYmEoMCwwLDAsLjEpfS4tLWZhY2Vib29re2JhY2tncm91bmQtY29sb3I6IzRjNjliYTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjNGM2OWJhLCMzYjU1YTApO3RleHQtc2hhZG93OjAgLTFweCAwICMzNTRjOGN9Li0tZmFjZWJvb2s6YmVmb3Jle2JvcmRlci1yaWdodDoxcHggc29saWQgIzM2NGU5MjtiYWNrZ3JvdW5kOnVybChodHRwczovL3MzLXVzLXdlc3QtMi5hbWF6b25hd3MuY29tL3MuY2Rwbi5pby8xNDA4Mi9pY29uX2ZhY2Vib29rLnBuZykgNnB4IDZweCBuby1yZXBlYXR9Li0tZmFjZWJvb2s6Zm9jdXMsLi0tZmFjZWJvb2s6aG92ZXJ7YmFja2dyb3VuZC1jb2xvcjojNWI3YmQ1O2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KCM1YjdiZDUsIzQ4NjRiMSl9Li0tZ29vZ2xle2JhY2tncm91bmQ6I2RkNGIzOX0uLS1nb29nbGU6YmVmb3Jle2JvcmRlci1yaWdodDoxcHggc29saWQgI2JiM2YzMDtiYWNrZ3JvdW5kOnVybChodHRwczovL3MzLXVzLXdlc3QtMi5hbWF6b25hd3MuY29tL3MuY2Rwbi5pby8xNDA4Mi9pY29uX2dvb2dsZS5wbmcpIDZweCA2cHggbm8tcmVwZWF0fS4tLWdvb2dsZTpmb2N1cywuLS1nb29nbGU6aG92ZXJ7YmFja2dyb3VuZDojZTc0YjM3fWBdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRmFjZWJvb2tMb2dpbkJ1dHRvbiBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIEBJbnB1dCgpIHNpemU6IHN0cmluZztcclxuICBASW5wdXQoKSBzY29wZXM6IFtzdHJpbmddO1xyXG4gIEBPdXRwdXQoKSBzb2NpYWxVc2VyID0gbmV3IEV2ZW50RW1pdHRlcjxTb2NpYWxVc2VyPigpO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvY2lhbEF1dGhTZXJ2aWNlOiBTb2NpYWxTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNvY2lhbFNpZ25JbigpIHsgICAgXHJcbiAgICB0aGlzLnNvY2lhbEF1dGhTZXJ2aWNlLnNpZ25JbignZmFjZWJvb2snLCB0aGlzLnNjb3BlcykudGhlbihcclxuICAgICAgKHVzZXJEYXRhOlNvY2lhbFVzZXIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInNvY2lhbFNpZ25JblwiLCB1c2VyRGF0YSk7XHJcbiAgICAgICB0aGlzLnNvY2lhbFVzZXIuZW1pdCh1c2VyRGF0YSlcclxuICAgICAgfVxyXG4gICAgKS5jYXRjaCgoKT0+e1xyXG4gICAgICAgIHRoaXMuc29jaWFsVXNlci5lbWl0KG51bGwpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHtTb2NpYWxTZXJ2aWNlfSBmcm9tICcuLi9zb2NpYWwuc2VydmljZSc7XHJcbmltcG9ydCB7IFNvY2lhbFVzZXIgfSBmcm9tICcuLi9lbnRpdGllcyc7XHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnZ29vZ2xlLWxvZ2luLWJ1dHRvbicsXHJcbiAgdGVtcGxhdGU6IGBcclxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0bi1ibG9jayBsb2dpbkJ0biAtLWdvb2dsZVwiIFxyXG4gICAgICAgICAgICAgIChjbGljayk9XCJzb2NpYWxTaWduSW4oKVwiIHR5cGU9XCJidXR0b25cIj5cclxuICAgICAgICAgIExvZ2luIHdpdGggR29vZ2xlXHJcbiAgICAgIDwvYnV0dG9uPlxyXG4gIGAsIHN0eWxlczogW2AuYnV0dG9ue2ZvbnQtZmFtaWx5OkxhdG8sXCJMdWNpZGEgR3JhbmRlXCIsXCJMdWNpZGEgU2FucyBVbmljb2RlXCIsVGFob21hLFNhbnMtU2VyaWY7LXdlYmtpdC1hcHBlYXJhbmNlOm5vbmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7b3V0bGluZTowO2JvcmRlci1yYWRpdXM6M3B4O2JvcmRlcjozcHggc29saWQgdHJhbnNwYXJlbnQ7Y3Vyc29yOnBvaW50ZXI7dGV4dC1vdmVyZmxvdzplbGxpcHNpczt0ZXh0LWRlY29yYXRpb246bm9uZSFpbXBvcnRhbnQ7Zm9udC13ZWlnaHQ6NDAwIWltcG9ydGFudH0ubG9naW5CdG57Ym94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO21hcmdpbjouMmVtO3BhZGRpbmc6MCAxNXB4IDAgNDZweDtib3JkZXI6bm9uZTt0ZXh0LWFsaWduOmxlZnQ7bGluZS1oZWlnaHQ6MzRweDt3aGl0ZS1zcGFjZTpub3dyYXA7Ym9yZGVyLXJhZGl1czozcHg7Zm9udC1zaXplOjE2cHg7Y29sb3I6I2ZmZn0ubG9naW5CdG46YmVmb3Jle2NvbnRlbnQ6XCJcIjtib3gtc2l6aW5nOmJvcmRlci1ib3g7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjM0cHg7aGVpZ2h0OjEwMCV9LmxvZ2luQnRuOmZvY3Vze291dGxpbmU6MH0ubG9naW5CdG46YWN0aXZle2JveC1zaGFkb3c6aW5zZXQgMCAwIDAgMzJweCByZ2JhKDAsMCwwLC4xKX0uc2hhcmVCdG57Ym94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO21hcmdpbjouMmVtO3BhZGRpbmc6MCAxNXB4IDAgNDZweDtib3JkZXI6bm9uZTt0ZXh0LWFsaWduOmxlZnQ7bGluZS1oZWlnaHQ6MzRweDt3aGl0ZS1zcGFjZTpub3dyYXA7Ym9yZGVyLXJhZGl1czozcHg7Zm9udC1zaXplOjE2cHg7Y29sb3I6I2ZmZn0uc2hhcmVCdG46YmVmb3Jle2NvbnRlbnQ6XCJcIjtib3gtc2l6aW5nOmJvcmRlci1ib3g7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3dpZHRoOjM0cHg7aGVpZ2h0OjEwMCV9LnNoYXJlQnRuOmZvY3Vze291dGxpbmU6MH0uc2hhcmVCdG46YWN0aXZle2JveC1zaGFkb3c6aW5zZXQgMCAwIDAgMzJweCByZ2JhKDAsMCwwLC4xKX0uLS1mYWNlYm9va3tiYWNrZ3JvdW5kLWNvbG9yOiM0YzY5YmE7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoIzRjNjliYSwjM2I1NWEwKTt0ZXh0LXNoYWRvdzowIC0xcHggMCAjMzU0YzhjfS4tLWZhY2Vib29rOmJlZm9yZXtib3JkZXItcmlnaHQ6MXB4IHNvbGlkICMzNjRlOTI7YmFja2dyb3VuZDp1cmwoaHR0cHM6Ly9zMy11cy13ZXN0LTIuYW1hem9uYXdzLmNvbS9zLmNkcG4uaW8vMTQwODIvaWNvbl9mYWNlYm9vay5wbmcpIDZweCA2cHggbm8tcmVwZWF0fS4tLWZhY2Vib29rOmZvY3VzLC4tLWZhY2Vib29rOmhvdmVye2JhY2tncm91bmQtY29sb3I6IzViN2JkNTtiYWNrZ3JvdW5kLWltYWdlOmxpbmVhci1ncmFkaWVudCgjNWI3YmQ1LCM0ODY0YjEpfS4tLWdvb2dsZXtiYWNrZ3JvdW5kOiNkZDRiMzl9Li0tZ29vZ2xlOmJlZm9yZXtib3JkZXItcmlnaHQ6MXB4IHNvbGlkICNiYjNmMzA7YmFja2dyb3VuZDp1cmwoaHR0cHM6Ly9zMy11cy13ZXN0LTIuYW1hem9uYXdzLmNvbS9zLmNkcG4uaW8vMTQwODIvaWNvbl9nb29nbGUucG5nKSA2cHggNnB4IG5vLXJlcGVhdH0uLS1nb29nbGU6Zm9jdXMsLi0tZ29vZ2xlOmhvdmVye2JhY2tncm91bmQ6I2U3NGIzN31gXSxcclxuXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBHb29nbGVMb2dpbkJ1dHRvbiBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcblxyXG4gIEBJbnB1dCgpIHNpemU6IHN0cmluZztcclxuICBASW5wdXQoKSBzY29wZXM6IFtzdHJpbmddO1xyXG4gIEBPdXRwdXQoKSBzb2NpYWxVc2VyID0gbmV3IEV2ZW50RW1pdHRlcjxTb2NpYWxVc2VyPigpO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNvY2lhbEF1dGhTZXJ2aWNlOiBTb2NpYWxTZXJ2aWNlKSB7IH1cclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcblxyXG4gIH1cclxuXHJcbiAgcHVibGljIHNvY2lhbFNpZ25JbigpIHsgICAgXHJcbiAgICB0aGlzLnNvY2lhbEF1dGhTZXJ2aWNlLnNpZ25JbignZ29vZ2xlJywgdGhpcy5zY29wZXMpLnRoZW4oXHJcbiAgICAgICh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICAgdGhpcy5zb2NpYWxVc2VyLmVtaXQodXNlckRhdGEpXHJcbiAgICAgIH1cclxuICAgICkuY2F0Y2goKCk9PntcclxuICAgICAgICB0aGlzLnNvY2lhbFVzZXIuZW1pdChudWxsKTtcclxuICAgIH0pOztcclxuICB9XHJcblxyXG59XHJcbiIsImltcG9ydCB7Q29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgSW5qZWN0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcclxuXHJcbmltcG9ydCB7U29jaWFsU2VydmljZX0gZnJvbSAnLi4vc29jaWFsLnNlcnZpY2UnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ2ZhY2Vib29rLXNoYXJlLWJ1dHRvbicsXHJcbiAgICB0ZW1wbGF0ZTogYFxyXG4gICAgICA8YnV0dG9uIGNsYXNzPVwiYnV0dG9uIGJ0bi1ibG9jayBsb2dpbkJ0biAtLWZhY2Vib29rXCIgXHJcbiAgICAgICAgICAgICAgKGNsaWNrKT1cInNoYXJpbmcoKVwiIHR5cGU9XCJidXR0b25cIj5TaGFyZTwvYnV0dG9uPlxyXG4gIGAsXHJcbiAgICBzdHlsZXM6IFtgLmJ1dHRvbntmb250LWZhbWlseTpMYXRvLFwiTHVjaWRhIEdyYW5kZVwiLFwiTHVjaWRhIFNhbnMgVW5pY29kZVwiLFRhaG9tYSxTYW5zLVNlcmlmOy13ZWJraXQtYXBwZWFyYW5jZTpub25lO2Rpc3BsYXk6aW5saW5lLWJsb2NrO291dGxpbmU6MDtib3JkZXItcmFkaXVzOjNweDtib3JkZXI6M3B4IHNvbGlkIHRyYW5zcGFyZW50O2N1cnNvcjpwb2ludGVyO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXM7dGV4dC1kZWNvcmF0aW9uOm5vbmUhaW1wb3J0YW50O2ZvbnQtd2VpZ2h0OjQwMCFpbXBvcnRhbnR9LmxvZ2luQnRue2JveC1zaXppbmc6Ym9yZGVyLWJveDtwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW46LjJlbTtwYWRkaW5nOjAgMTVweCAwIDQ2cHg7Ym9yZGVyOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjM0cHg7d2hpdGUtc3BhY2U6bm93cmFwO2JvcmRlci1yYWRpdXM6M3B4O2ZvbnQtc2l6ZToxNnB4O2NvbG9yOiNmZmZ9LmxvZ2luQnRuOmJlZm9yZXtjb250ZW50OlwiXCI7Ym94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDozNHB4O2hlaWdodDoxMDAlfS5sb2dpbkJ0bjpmb2N1c3tvdXRsaW5lOjB9LmxvZ2luQnRuOmFjdGl2ZXtib3gtc2hhZG93Omluc2V0IDAgMCAwIDMycHggcmdiYSgwLDAsMCwuMSl9LnNoYXJlQnRue2JveC1zaXppbmc6Ym9yZGVyLWJveDtwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW46LjJlbTtwYWRkaW5nOjAgMTVweCAwIDQ2cHg7Ym9yZGVyOm5vbmU7dGV4dC1hbGlnbjpsZWZ0O2xpbmUtaGVpZ2h0OjM0cHg7d2hpdGUtc3BhY2U6bm93cmFwO2JvcmRlci1yYWRpdXM6M3B4O2ZvbnQtc2l6ZToxNnB4O2NvbG9yOiNmZmZ9LnNoYXJlQnRuOmJlZm9yZXtjb250ZW50OlwiXCI7Ym94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDozNHB4O2hlaWdodDoxMDAlfS5zaGFyZUJ0bjpmb2N1c3tvdXRsaW5lOjB9LnNoYXJlQnRuOmFjdGl2ZXtib3gtc2hhZG93Omluc2V0IDAgMCAwIDMycHggcmdiYSgwLDAsMCwuMSl9Li0tZmFjZWJvb2t7YmFja2dyb3VuZC1jb2xvcjojNGM2OWJhO2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KCM0YzY5YmEsIzNiNTVhMCk7dGV4dC1zaGFkb3c6MCAtMXB4IDAgIzM1NGM4Y30uLS1mYWNlYm9vazpiZWZvcmV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjMzY0ZTkyO2JhY2tncm91bmQ6dXJsKGh0dHBzOi8vczMtdXMtd2VzdC0yLmFtYXpvbmF3cy5jb20vcy5jZHBuLmlvLzE0MDgyL2ljb25fZmFjZWJvb2sucG5nKSA2cHggNnB4IG5vLXJlcGVhdH0uLS1mYWNlYm9vazpmb2N1cywuLS1mYWNlYm9vazpob3ZlcntiYWNrZ3JvdW5kLWNvbG9yOiM1YjdiZDU7YmFja2dyb3VuZC1pbWFnZTpsaW5lYXItZ3JhZGllbnQoIzViN2JkNSwjNDg2NGIxKX0uLS1nb29nbGV7YmFja2dyb3VuZDojZGQ0YjM5fS4tLWdvb2dsZTpiZWZvcmV7Ym9yZGVyLXJpZ2h0OjFweCBzb2xpZCAjYmIzZjMwO2JhY2tncm91bmQ6dXJsKGh0dHBzOi8vczMtdXMtd2VzdC0yLmFtYXpvbmF3cy5jb20vcy5jZHBuLmlvLzE0MDgyL2ljb25fZ29vZ2xlLnBuZykgNnB4IDZweCBuby1yZXBlYXR9Li0tZ29vZ2xlOmZvY3VzLC4tLWdvb2dsZTpob3ZlcntiYWNrZ3JvdW5kOiNlNzRiMzd9YF0sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBGYWNlYm9va1NoYXJpbmdCdXR0b24gaW1wbGVtZW50cyBPbkluaXQge1xyXG5cclxuICAgIEBJbnB1dCgpIHNoYXJlOiBhbnkgPSBudWxsO1xyXG4gICAgQE91dHB1dCgpIHJlc3BvbnNlID0gbmV3IEV2ZW50RW1pdHRlcjxCb29sZWFuPigpO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc29jaWFsQXV0aFNlcnZpY2U6IFNvY2lhbFNlcnZpY2UsXHJcbiAgICAgQEluamVjdChET0NVTUVOVCkgcHJpdmF0ZSBkb2N1bWVudDogYW55KSB7IH1cclxuXHJcbiAgICBuZ09uSW5pdCgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNoYXJpbmcoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5kb2N1bWVudC5sb2NhdGlvbi5ocmVmKTtcclxuICAgICAgICBpZighdGhpcy5zaGFyZSl7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmUgPSB7aHJlZjp0aGlzLmRvY3VtZW50LmxvY2F0aW9uLmhyZWZ9XHJcbiAgICAgICAgfWVsc2UgaWYoIXRoaXMuc2hhcmUuaHJlZil7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmUuaHJlZiA9IHRoaXMuZG9jdW1lbnQubG9jYXRpb24uaHJlZlxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNvY2lhbEF1dGhTZXJ2aWNlLmZhY2Vib29rU2hhcmluZyh0aGlzLnNoYXJlKS50aGVuKCgpPT57XHJcbiAgICAgICAgICAgIHRoaXMucmVzcG9uc2UuZW1pdCh0cnVlKTtcclxuICAgICAgICB9KS5jYXRjaCgoZXJyKT0+e1xyXG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlLmVtaXQoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBGYWNlYm9va0xvZ2luQnV0dG9uIH0gZnJvbSAnLi9idXR0b25zL2ZhY2Vib29rTG9naW5CdXR0b24nO1xyXG5pbXBvcnQgeyBHb29nbGVMb2dpbkJ1dHRvbiB9IGZyb20gJy4vYnV0dG9ucy9nb29nbGVMb2dpbkJ1dHRvbic7XHJcbmltcG9ydCB7RmFjZWJvb2tTaGFyaW5nQnV0dG9ufSBmcm9tIFwiLi9idXR0b25zL2ZhY2Vib29rU2hhcmluZ0J1dHRvblwiO1xyXG5cclxuQE5nTW9kdWxlKHtcclxuICBpbXBvcnRzOiBbXHJcblxyXG4gIF0sXHJcbiAgZGVjbGFyYXRpb25zOiBbRmFjZWJvb2tMb2dpbkJ1dHRvbiwgR29vZ2xlTG9naW5CdXR0b24sIEZhY2Vib29rU2hhcmluZ0J1dHRvbl0sXHJcbiAgZXhwb3J0czogW0ZhY2Vib29rTG9naW5CdXR0b24sIEdvb2dsZUxvZ2luQnV0dG9uLCBGYWNlYm9va1NoYXJpbmdCdXR0b25dXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBbmd1bGFyNlNvY2lhbEJ1dHRvbk1vZHVsZSB7IH1cclxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBR0E7SUFHSSxpQkFBZ0I7Ozs7OztJQVFsQixVQUFVLENBQUMsR0FBdUIsRUFBRSxNQUFXO1FBQzdDLElBQUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFBRSxPQUFPO1NBQUU7O1FBQ2xELElBQUksUUFBUSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDaEQsUUFBUSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDdEIsUUFBUSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDO1FBQ3ZCLFFBQVEsQ0FB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